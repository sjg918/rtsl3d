
from CFG import cfg
from dataset_process.kittidataset import KittiDataset 

import torch

from models.back import VoxelFeatureExtractor

kew = KittiDataset(cfg)
back = VoxelFeatureExtractor(4, cfg.voxelshape)
for i in range(len(kew)):
    voxels, coors, num_points_per_voxel = kew[i]
    voxels = torch.from_numpy(voxels)
    coors = torch.from_numpy(coors)
    num_points_per_voxel = torch.from_numpy(num_points_per_voxel)
    print(voxels.shape, coors.shape, num_points_per_voxel.shape)

    mask = coors

    df=df
    kew = back(voxels, coors, num_points_per_voxel)
    print(kew.shape)
    #voxels, coors, num_points_per_voxel = kew[i]
    #print(voxels.shape)
