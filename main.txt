
from CFG import cfg
from dataset_process.kittidataset import KittiDataset 

import torch
import numpy as np

from models.back import VoxelFeatureExtractor

kew = KittiDataset(cfg)
back = VoxelFeatureExtractor(cfg).cuda()

for i in range(len(kew)):
    voxels, voxelmask, bevsidx, bevcoors, bevmask, target = kew[i]
    df=-df
    #voxels = torch.from_numpy(voxels).to(torch.float32).cuda(0)
    voxelmask = torch.from_numpy(voxelmask).unsqueeze(dim=-1).to(torch.float32)
    #bevsidx = torch.from_numpy(bevsidx).to(torch.long).cuda(0)
    #bevcoors = torch.from_numpy(bevcoors).to(torch.long).cuda(0)
    bevmask = torch.from_numpy(bevmask).unsqueeze(dim=1).to(torch.float32)


    #rqt = back(voxels, voxelmask, bevsidx, bevcoors, bevmask)
    #back.zero_grad()
